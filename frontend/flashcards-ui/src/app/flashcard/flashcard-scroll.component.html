<div class="card-view-wrapper" *ngIf="currentCard">
  <div class="flashcard-container">
    <!-- Swipe area wrapper - covers entire card -->
    <div class="swipe-area"
      (touchstart)="onTouchStart($event, currentCard)"
      (touchmove)="onTouchMove($event, currentCard)"
      (touchend)="onTouchEnd($event, currentCard)"
      (touchcancel)="onTouchCancel($event)"
      (pointerdown)="onPointerStart($event, currentCard)"
      (pointerup)="onPointerEnd($event, currentCard)"
      (pointercancel)="onPointerCancel($event)"
    >
      <section class="qa-section question" *ngIf="!currentCard.showAnswer">
        <div class="content-wrapper">
          <img
            *ngIf="currentCard.questionImage"
            [src]="apiUrl + '/images/' + currentCard.questionImage"
            class="flashcard-image"
            alt="question image"
          />
          <pre class="card-text question-text">{{ currentCard.question }}</pre>
        </div>
      </section>

      <section class="qa-section answer" *ngIf="currentCard.showAnswer">
        <div class="content-wrapper scrollable">
          <app-flashcard-answer
            [answer]="currentCard.answer"
            [image]="currentCard.answerImage || ''"
          ></app-flashcard-answer>
          <div *ngIf="currentCard.explanation" class="alert alert-info text-start mt-3">
            <img
              *ngIf="currentCard.explanationImage"
              [src]="apiUrl + '/images/' + currentCard.explanationImage"
              class="flashcard-image"
              alt="explanation image"
            />
            {{ currentCard.explanation }}
          </div>
        </div>
      </section>
    </div>

    <!-- Thumb buttons -->
    <div class="thumb-buttons-container">
      <button class="btn btn-danger btn-lg thumb-btn" (click)="vote(currentCard, false)" title="Need to review">
        <span class="thumb-icon">👎</span>
        <span class="thumb-label">Review</span>
      </button>
      <button class="btn btn-success btn-lg thumb-btn" (click)="vote(currentCard, true)" title="I know this">
        <span class="thumb-icon">👍</span>
        <span class="thumb-label">Know It</span>
      </button>
    </div>

    <!-- Other action buttons -->
    <div class="d-flex justify-content-center align-items-center flex-wrap mt-3 gap-2">
      <button class="btn btn-secondary" (click)="toggleAnswer(currentCard)">🔁 Flip</button>
      <button class="btn btn-warning" (click)="readAloud(currentCard)">🔊 Voice</button>
      <button class="btn btn-outline-secondary" (click)="editCard(currentCard)">✏️ Edit</button>
    </div>

    <!-- Card counter -->
    <div class="text-center text-muted mt-3 small">
      Card {{ currentCardIndex + 1 }} of {{ flashcards.length }}
    </div>
  </div>
</div>

<div class="text-center mt-5" *ngIf="!currentCard && flashcards.length === 0">
  <h3>No flashcards available</h3>
</div>

<div class="text-center mt-5" *ngIf="!currentCard && flashcards.length > 0">
  <h3>🎉 All done!</h3>
  <p>You've reviewed all the flashcards in this deck.</p>
  <button class="btn btn-primary" (click)="resetDeck()">Review Again</button>
</div>
