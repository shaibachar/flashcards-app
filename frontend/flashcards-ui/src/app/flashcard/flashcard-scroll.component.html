<div class="scroll-wrapper" [ngClass]="{'answer-shown': hasAnyAnswerShown()}" *ngIf="flashcards.length">
  <ng-container *ngFor="let card of flashcards; trackBy: trackByCardId">
    <div class="scroll-card">
      <!-- Swipe area wrapper - covers entire card -->
      <div class="swipe-area"
        (touchstart)="onTouchStart($event, card)"
        (touchmove)="onTouchMove($event, card)"
        (touchend)="onTouchEnd($event, card)"
        (touchcancel)="onTouchCancel($event)"
        (pointerdown)="onPointerStart($event, card)"
        (pointerup)="onPointerEnd($event, card)"
        (pointercancel)="onPointerCancel($event)"
      >
        <section class="qa-section question" *ngIf="!card.showAnswer">
          <div class="content-wrapper">
            <img
              *ngIf="card.questionImage"
              [src]="apiUrl + '/images/' + card.questionImage"
              class="flashcard-image"
              alt="question image"
            />
            <pre class="card-text question-text">{{ card.question }}</pre>
          </div>
        </section>

        <section class="qa-section answer" *ngIf="card.showAnswer">
          <div class="content-wrapper scrollable">
            <app-flashcard-answer
              [answer]="card.answer"
              [image]="card.answerImage || ''"
            ></app-flashcard-answer>
            <div *ngIf="card.explanation" class="alert alert-info text-start mt-3">
              <img
                *ngIf="card.explanationImage"
                [src]="apiUrl + '/images/' + card.explanationImage"
                class="flashcard-image"
                alt="explanation image"
              />
              {{ card.explanation }}
            </div>
          </div>
        </section>
      </div>

      <div class="d-flex justify-content-center align-items-center flex-wrap mt-3 gap-2">
        <button class="btn btn-success" (click)="vote(card, true)" title="I know this">
          👍 Know It
        </button>
        <button class="btn btn-danger" (click)="vote(card, false)" title="Need to review">
          👎 Review
        </button>
        <button class="btn btn-secondary" (click)="toggleAnswer(card)">🔁 Flip</button>
        <button class="btn btn-warning" (click)="readAloud(card)">🔊 Voice</button>
        <button class="btn btn-outline-secondary" (click)="editCard(card)">✏️ Edit</button>
      </div>
      <div class="text-center text-muted mt-2 small">
        Swipe right (or 👍) to mark known, left (or 👎) to revisit later.
      </div>
    </div>
  </ng-container>
</div>
